<?xml version="1.0" encoding="utf-8" ?>
<ContentPage x:Class="NutritionDiary.Views.DiaryEntryPage"
             xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             Title="Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð·Ð°Ð¿Ð¸ÑÑŒ">

    <ScrollView>
        <VerticalStackLayout Spacing="15" Padding="20">

            <!-- Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº -->
            <Label x:Name="TitleLabel"
                   FontSize="18"
                   FontAttributes="Bold"
                   HorizontalOptions="Center" />

            <!-- ÐŸÐ¾Ð¸ÑÐº Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ð° -->
            <Label Text="ÐŸÐ¾Ð¸ÑÐº Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ð°:" />
            <SearchBar x:Name="ProductSearchBar"
                       TextColor="Black"
                      Placeholder="ÐÐ°Ñ‡Ð½Ð¸Ñ‚Ðµ Ð²Ð²Ð¾Ð´Ð¸Ñ‚ÑŒ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ð°..."
                      TextChanged="OnSearchTextChanged"
                      BackgroundColor="White" />

            <!-- Ð¡Ð¿Ð¸ÑÐ¾Ðº Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ð¾Ð² -->
            <Label Text="Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚:" />
            <ListView x:Name="ProductsListView"
                      HeightRequest="200"
                      ItemSelected="OnProductSelectedFromList"
                      HasUnevenRows="True">
                <ListView.ItemTemplate>
                    <DataTemplate>
                        <ViewCell>
                            <Grid Padding="15,10" 
                                  BackgroundColor="{Binding IsSelected, Converter={x:StaticResource SelectedColorConverter}}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <VerticalStackLayout Grid.Column="0" Spacing="2">
                                    <Label Text="{Binding Name}" 
                                           FontSize="14" 
                                           FontAttributes="Bold"
                                           TextColor="{Binding IsSelected, Converter={x:StaticResource TextColorConverter}}" />
                                    <Label Text="{Binding CaloriesPer100g, StringFormat='{0} ÐºÐºÐ°Ð»/100Ð³'}" 
                                           FontSize="12" 
                                           TextColor="{Binding IsSelected, Converter={x:StaticResource SubtextColorConverter}}" />
                                </VerticalStackLayout>

                                <Label Grid.Column="1" 
                                       Text="âœ…" 
                                       FontSize="16" 
                                       IsVisible="{Binding IsSelected}" />
                            </Grid>
                        </ViewCell>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>
            
            <Label Text="Ð’Ñ‹Ð±Ñ€Ð°Ð½Ð½Ñ‹Ð¹ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚:" />
            
            <!-- Ð’Ñ‹Ð±Ñ€Ð°Ð½Ð½Ñ‹Ð¹ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚ -->
            <Frame x:Name="SelectedProductFrame"
                   BackgroundColor="#E8F5E8"
                   Padding="15"
                   CornerRadius="10"
                   IsVisible="False">
                <HorizontalStackLayout Spacing="10">
                    <Label Text="âœ…" 
                           FontSize="16"
                           VerticalOptions="Center" />
                    <VerticalStackLayout Spacing="2">
                        <Label x:Name="SelectedProductName"
                               Text="ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ð°"
                               TextColor="Black"
                               FontSize="14"
                               FontAttributes="Bold" />
                        <Label x:Name="SelectedProductCalories"
                               Text="0 ÐºÐºÐ°Ð»/100Ð³"
                               FontSize="12"
                               TextColor="Gray" />
                    </VerticalStackLayout>
                </HorizontalStackLayout>
            </Frame>

            <!-- ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ -->
            <Label Text="ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ (Ð³Ñ€Ð°Ð¼Ð¼Ñ‹):" />
            <Entry x:Name="QuantityEntry"
                   Text="100"
                   Keyboard="Numeric" />

            <!-- ÐŸÐ¸Ñ‚Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð°Ñ Ñ†ÐµÐ½Ð½Ð¾ÑÑ‚ÑŒ -->
            <Frame BackgroundColor="White"
                   Padding="15"
                   CornerRadius="10">
                <VerticalStackLayout Spacing="8">
                    <Label Text="ÐŸÐ¸Ñ‚Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð°Ñ Ñ†ÐµÐ½Ð½Ð¾ÑÑ‚ÑŒ:" 
                           TextColor="DarkSlateGrey"
                           FontAttributes="Bold" />

                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <Label Grid.Row="0" Grid.Column="0" Text="ÐšÐ°Ð»Ð¾Ñ€Ð¸Ð¸:" TextColor="Black" />
                        <Label x:Name="CaloriesLabel" Grid.Row="0" Grid.Column="1" Text="0" TextColor="Black" />

                        <Label Grid.Row="1" Grid.Column="0" Text="Ð‘ÐµÐ»ÐºÐ¸:" TextColor="Black" />
                        <Label x:Name="ProteinLabel" Grid.Row="1" Grid.Column="1" Text="0 Ð³" TextColor="Black" />

                        <Label Grid.Row="2" Grid.Column="0" Text="Ð–Ð¸Ñ€Ñ‹:" TextColor="Black" />
                        <Label x:Name="FatLabel" Grid.Row="2" Grid.Column="1" Text="0 Ð³" TextColor="Black" />

                        <Label Grid.Row="3" Grid.Column="0" Text="Ð£Ð³Ð»ÐµÐ²Ð¾Ð´Ñ‹:" TextColor="Black" />
                        <Label x:Name="CarbsLabel" Grid.Row="3" Grid.Column="1" Text="0 Ð³" TextColor="Black" />
                    </Grid>
                </VerticalStackLayout>
            </Frame>

            <!-- ÐšÐ½Ð¾Ð¿ÐºÐ° ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ ÑÐ²Ð¾ÐµÐ³Ð¾ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ð° -->
            <Button x:Name="AddCustomProductButton"
                    Text="âž• Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ ÑÐ²Ð¾Ð¹ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚"
                    BackgroundColor="#4682B4"
                    TextColor="White"
                    Margin="0,10,0,0"
                    Clicked="OnAddCustomProductClicked" />


            <!--<Button x:Name="ScanBarcodeButton"
        Text="ðŸ“· Ð¡ÐºÐ°Ð½Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ ÑˆÑ‚Ñ€Ð¸Ñ…-ÐºÐ¾Ð´"
        BackgroundColor="#FF9800"
        TextColor="White"
        Margin="0,10,0,0"
        Clicked="OnScanBarcodeClicked" />-->



            <!-- ÐšÐ½Ð¾Ð¿ÐºÐ¸ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ð¹ -->
            <Grid ColumnDefinitions="*,*" ColumnSpacing="10">
                <Button Grid.Column="0"
                        Text="Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ"
                        BackgroundColor="Green"
                        TextColor="White"
                        Clicked="OnSaveClicked" />

                <Button Grid.Column="1"
                        Text="ÐžÑ‚Ð¼ÐµÐ½Ð°"
                        BackgroundColor="Gray"
                        TextColor="White"
                        Clicked="OnCancelClicked" />
            </Grid>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>